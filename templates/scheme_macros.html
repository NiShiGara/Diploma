<!DOCTYPE html>

<!--Макрос для вывода данных схемы выкройки-->
{% macro render_pattern_scheme(pattern, checked_value) %}
    <div class="block_scheme">
        <div class="data">
            <p class="fig">
                <span class="product-title">{{ pattern.loc[0, "Название"] }}</span>
            </p>
            <p class="fig">
                <span class="product-caption">{{ pattern.loc[0, "Категория"] }}</span>
            </p>
            {% if checked_value == True %}
                <p class="fig">
                    <img src="static/scheme.jpg" alt="" style="width: 450px; height: auto;">
                </p>
                <p class="fig">
                    <a href="static/scheme.jpg" download>
                        <input type="button" value="Скачать изображение" class="button button_search">
                    </a>
                </p>
            {% else %}
                <p class="fig">
                    <img src="{{ pattern.loc[0,'Изображение']}}" alt="">
                </p>
            {% endif %}
        </div>
    </div>
{% endmacro %}

<!--Макрос для вывода мерок схемы выкройки с параметрами пользователя-->
{% macro render_measure_pattern(measure, param, len, zip) %}
{% for i in range(len(measure)) %}
    <div class="block_detail">
        {% set measure = measure.iloc[i] %}

        <div class="title title-2">
            <p>Детали "{{ measure["Название_детали"] }}":</p>
        </div>

        {% set full_title = measure["Полное_название"].split(",") %}
        {% set designation = measure["Обозначение"].split(",") %}

        <table style="display: flex; justify-content: center;">
            {% for full_title, designation in zip(full_title, designation) %}
            <tr>
                <td>
                    {{ full_title }} ({{ designation }}):
                    <label>
                        <input hidden type="text" name="param_designation" value="{{designation}}">
                        <input hidden type="text" name="detail" value="{{ measure['ID'] }}">
                    </label>
                </td>

                <td>
                    {% if designation not in param["Обозначение"].unique() %}
                    <label>
                        <input type="text" name="param_value" class="write_personal" value=""
                               placeholder="необходимо заполнить">
                    </label>
                    {% endif %}

                    {% for j in range(len(param)) %}
                        {% if param.loc[j, "Обозначение"] == designation %}
                            {% if ('ID' in param.columns and param.loc[j, 'ID'] == measure['ID']) or 'ID' not in param.columns %}
                                <label>
                                    {% if param.loc[j, "Значение"] != '' %}
                                    <input type="text" name="param_value" class="write_personal"
                                           value="{{ param.loc[j, 'Значение']}}" placeholder="{{ param.loc[j, 'Значение']}}">
                                    {% else %}
                                    <input type="text" name="param_value" class="write_personal" value=""
                                           placeholder="необходимо заполнить">
                                    {% endif %}
                                </label>
                            {% endif %}
                        {% endif %}
                    {% endfor %}
                </td>
            </tr>
            {% endfor %}
        </table>
    </div>

    <div class="container_button">
        <input type="submit" name="build_scheme" value="Построить" class="button button_build">
        <input type="submit" value="Отменить изменения" onclick="window.location.reload()" class="button button_build">
    </div>
{% endfor %}
{% endmacro %}